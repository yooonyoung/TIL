## AWS 비용 최적화하기


<h4>전통 하드웨어 서버가 클라우드로 이전하는 이유는?</h4>

- 물리적 서버나 하드웨어를 구매할 때마다 계단식으로 비용이 발생하게 된다. 하지만 실제 서버의 수요는 변곡선을 그리면서 비용이 발생한다. 그래서 때에 따라 기회비용이 생기거나 비즈니스 손실이 발생할 수 있다.
- 인프라 비용을 최적화하면 불필요한 비용이 발생하지 않고 탄력적이고 유연하게 대응되기 때문에. 즉, 사용한 Usage에 대해서만 비용을 지불할 수 있기 때문에 경제적으로 장점이 있다.



<h4>클라우드 비용관리란?</h4>

- **비용에 대한 가시성, 이해도 높이기** - 현재 사용하고 있는 서비스가 이 아키텍처가 적합한지.
- **최적화 방법을 실행하는 것** - 계획을 실제로 행동으로 옮긴다. 최적화 방법을 실제로 워크로드에 적용하고 추가적으로 절감 기회가 있는지 Usage 트렌드를 살피고 또다른 액션을 취한다.
- **비용관리 메커니즘 만들기** - 클라우드 비용 절감과 관련된 목표를 내부에서 수립해야 한다. 목표에 도달한다면 그 다음 목표는 무엇인지, 도달하지 못했다면 그 이유는 무엇인지 모니터링을 통해 원인을 분석한다. 



#### 가시성 확보하기 위한 AWS 툴

- **AWS Organization**
  
  - 워크로드 환경과 AWS 계정을 한 데에 모아 중앙 집중식으로 관리
  
  - 새 AWS 계정 생성 가능, 그룹화하여 Work Flow 구성 가능
  
  - 특정 계정이나 그룹에 원하는 정책을 적용 가능
  - 모든 계정에 대해 단일 결제 방법을 사용하므로 비용 청구가 간소화된다.
- **AWS 예산(Budget)**
  
  - 특정 조직이나 프로젝트의 예산을 설정하고, 책정한 임계값을 초과되면 알림을 받을 수 있다.
  
  - 예약 인스턴스, Savings Plans (AWS의 가격 정책)
  
- **AWS 비용 이상 탐지(Cost Anomaly Detection)**
  
  - 사용자의 개입을 최소화, 일회성 비용의 급증이나 점진적 증가 등 다양한 이상 현상을 감지한다. 근본적인 원인 분석을 제공해서 이상 현상을 빠르게 알 수 있다. 
  - 직접 임계값을 설정하고 알림을 받을 수도 있다.



#### HOW? 최적화 방법 이해와 실천

1. **리소스에 알맞은 사이즈의 인스턴스 사용**

   - 리소스 최적화 (Rightsizing)

     Performance needs를 충족하면서도 가장 저렴한 인스턴스를 선택

     Amazon CloudWatch, Compute Optimizer, Cost Explorer의 `절감 사항` 활용
     
     

2. **탄력적인 리소스 운영**

   리소스를 탄력적으로, 수요에 따라 유연하게 운영하는 것이 클라우드의 가장 큰 장점

   만약 테스트 환경이라면 근무 시간에 맞추어 중지, 그리고 재 시작할 수 있도록 스케줄링 가능

   좀 더 타이트하게 관리하여 업무 시간에만 켜져있도록 한다면 일주일 내내 키는 것보다 70% 비용 절감 가능
   
   - AWS Instance Schedular 활용 - EC2와 RDS 인스턴스의 시작, 중지 일정을 지정할 수 있다.
     - Auto Scaling으로도 최대한 낮은 비용으로 성능을 유지할 수 있다.



3. **AWS 가격 정책 사용**
   - 온 디맨드 : 약정 없이 사용한 EC2 인스턴스에 대한 비용만 지불. 트래픽 예측 불가 시 사용
   - 예약 인스턴스 (RI) : 1년이나 3년 약정으로 온디맨드 대비 최대 75% 절약. 일정/항시 켜두어야 하는 워크로드일 때 사용. EC2, RDS Redshift, ElastiCache, Elastisearch
   - 세이빙스 플랜 (SP) : 1년이나 3년 약정으로 온디맨드 대비 최대 72% 절약. 일정/항시 켜두어야 하는 워크로드일 때 사용. EC2, Fargate, Lambda
   - 스팟 인스턴스 : 예비 컴퓨팅 용량을 통해 온디맨드 대비 최대 90% 절약. 유휴 컴퓨팅 리소스를 이용해 절약률이 크지만, 다른 곳에서 많이 쓸 경우 중단될 수 있다. 시간 제한이 없는 배치성 워크로드에 사용. (테스팅)



4. **알맞은 Storage class 사용 - S3**
   - Standard (default) : 데이터에 자주 액세스하는 클래스, 비용이 가장 높지만 데이터를 불러오는 속도가 가장 빠르다.
   - Amazon Glacier : 비용이 가장 저렴하지만, 데이터를 다시 불러오는 시간과 비용이 많이 든다.
   - S3 Intelligent : 데이터의 액세스 패턴 파악이 어려운 경우 사용. 소액의 모니터링 및 자동화 요금으로, 데이터의 액세스 패턴을 파악한다. 액세스 패턴을 아직 모르거나 변경될 수 있다면 지능적 티어가 적합할 수 있다.



#### HOW? 비용관리 메커니즘 만들기

비용 최적화 방안들을 실제로 실행하고 지속적으로 유지해나가는 것이 가장 중요하다.

1. 비용에 대한 올바른 이해하기

   현재 Usage 패턴을 파악하고, 선제적 액션을 취할 수 있도록 알림을 설정해본다.


2. Finance와 기술 파트의 협업

   상호 간 협력이 있어야 비용 최적화가 가능하다.
   
3. 관리와 자동화

   라이트사이징, 가격 정책 등을 알고 여러 프로세스를 자동화하는 과정이 필요하다.

4. 공통적인 목표를 세우고 Following

   함께 달성 가능한 골을 설정, 성공 여부를 트래킹하며 운영하고 있는 워크로드에 맞는 클라우드 환경을 구축



   

   


