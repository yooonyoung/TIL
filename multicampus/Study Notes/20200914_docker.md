<h2>Docker</h2>

복잡한 리눅스 애플리케이션을 컨테이너로 묶어서 실행할 수 있음

개발, 테스트, 서비스 환경을 하나로 통일하여 효율적으로 관리하는 것이 가능

컨테이너(이미지)를 전세계 사람들과 공유 가능

GitHub와 비슷한 방식의 Docker Hub 제공



- 코드로 관리하는 인프라 (Infrastructure as Code)

  코드 기반으로 인프라를 정의

  서버를 어떻게 구성할 것인지, 어떤 라이브러리와 도구를 설치할지를 코드로 정의하고 셰프(Chef)나 앤서블(Ansible) 같은 프로비저닝 도구로 서버를 구축

  수작업이 개입할 여지를 줄이고 코드 중심으로 바꾸어 쉽게 같은 구성의 서버 여러 대 복제 가능

  -> 항상 같은 결과가 보장되지는 않음. 멱등성 확보 불가능

- 불변 인프라 (Immutable Infrastructure)

  어떤 시점의 서버 상태를 저장해 복제할 수 있게 함

  제대로 설정된 상태의 서버를 항상 사용할 수 있음

  서버에 변경을 가하고 싶다면 기존 인프라를 수정하는 대신 새로운 서버를 구축하고 그 상태를 이미지로 저장한 후 그 이미지를 복제

  서비스가 업데이트되면 운영 환경 자체를 변경하지 않고 이미지를 새로 생성해서 배포

  - 편리한 관리
    - 서비스 환경 이미지만 관리하면 됨 
    - 중앙 관리를 통한 체계적인 배포와 관리
    -  이미지 생성에 버전 관리 시스템 활용
  - 확장
    - 이미지 하나로 서버를 계속 찍어낼 수 있음
    - 크라우드 플랫폼의 자동 확장 (Auto Scaling) 기능과 연동하여 손쉽게 서비스 확장
  - 테스트
    - 개발자 PC, 테스트 서버에서 이미지를 실행만 하면 서비스 운영 환경과 동일한 환경이 구성됨
    - 테스트가 간편
  - 가볍다
    - 운영체제와 서비스 환경을 분리하여 가볍고 (Lightweight) 어디서든 실행 가능한 (Portable) 환경 제공

- 우분투 가상머신 설치 및 도커 설치

  - 작업 디렉터리 생성 - C:\docker 디렉터리 생성

    ```
    C:\> mkdir c:\docker
    C:\> cd c:\docker
    c:\docker>
    ```

  - Vagrantfile 생성

    ```
    c:\docker> vagrant init	
    ```

  - 가상머신 생성
  
    ```
    c:\docker> vagrant up
    ```
  
  - 가상머신에 SSH로 접속
  
    ```
    c:\docker> vagrant ssh
    ```
  
  - 패키지 업데이트
  
    ```
    vagrant@xenial64:~$ sudo apt update
    vagrant@xenial64:~$ sudo apt upgrade
    ```
  
  - 도커 설치
  
    ```
    vagrant@xenial64:~$ sudo apt install -y docker.io
    vagrant@xenial64:~$ sudo usermod -a -G docker $USER
    vagrant@xenial64:~$ sudo service docker restart
    vagrant@xenial64:~$ sudo chmod 666 /var/run/docker.sock
    vagrant@xenial64:~$ docker --version
    Docker version 18.09.7, build 2d0083d
    ```
  
  
  
- 도커 이미지와 컨테이너

  - 도커 이미지

    도커 컨테이너를 구성하는 파일 싯템과 실행할 애플리케이션 설정을 하나로 합친 것으로, 컨테이너를 생성하는 템플릿 역할

  - 도커 컨테이너

    도커 이미지를 기반으로 생성되며, 파일 시스템과 애플리케이션이 구체화되어 실행되는 상태

  도커 이미지 하나로 여러 개의 컨테이너를 생성 가능

  각 컨테이너는 같은 이미지로 생성했다고 하더라도 별개의 상태를 가지게 됨

